(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{113:function(n,e,t){"use strict";t.r(e);var r=t(0),a=t.n(r),o=t(38),i=t.n(o),c=(t(94),t(95),t(18)),u=t(6),l={color:{black:"#000000",blackLighter:"#101010",gray:"#383635",grayLight:"#939393",white:"#ffffff",orange:"#f56c42",hslBlue:"#007ac9",hslGreen:"#00985f",hslOrange:"#ff6319",hslPurple:"#8c4799",hlsLightBlue:"#00b9e4"},fontSize:{base:"1rem",big:"1.25rem",small:"0.825rem",xsmall:"0.625rem",h1:"2.5rem",h2:"2rem",h3:"1.5rem"},fontWeight:{light:300,normal:400,medium:500}},s={apiKey:"5e581f69ad9c4225a83ac21d4bf37809",graphqlAPI:"https://api.digitransit.fi/routing/v1/routers/hsl/index/graphql",mqttVPAPIDev:"ws://localhost:4000/graphql",mqttVPAPIProd:"wss://buckets/graphql",mapEndpoint:"https://tile.thunderforest.com/transport/{z}/{x}/{y}.png?apikey=",hslMap:"https://cdn.digitransit.fi/map/v1/hsl-map/{z}/{x}/{y}@2x.png",initialRadius:150,maxRadius:1200,initialPositionCoords:{lat:60.1699,lng:24.9384}},d=t(2),f=t(71),m=new c.HttpLink({uri:s.graphqlAPI}),p=new f.a({uri:s.mqttVPAPIProd,options:{reconnect:!0}}),h=Object(c.split)((function(n){var e=n.query,t=Object(d.p)(e);return"OperationDefinition"===t.kind&&"subscription"===t.operation}),p,m),g=new c.ApolloClient({cache:new c.InMemoryCache,link:h}),v=t(4),b=t(11),x=t(73),y=t.n(x),E=t(74),O=t.n(E),w=a.a.createContext({initialLocation:{lat:0,lng:0},setInitialLocation:function(){},geoLocation:{lat:0,lng:0},setGeoLocation:function(){},radiusInMeters:0,setRadiusInMeters:function(){},currentRoute:{color:null,coordinates:null},setCurrentRoute:function(){},setStopData:function(){},stopData:null,setVehicleData:function(){},vehicleData:{vehicleType:-1,direction:"",vehicleCode:""}}),j=function(n,e){var t=a.a.useState(n),r=Object(b.a)(t,2),o=r[0],i=r[1];return a.a.useEffect((function(){var t=setTimeout((function(){i(n)}),e);return function(){clearTimeout(t)}}),[n,e]),o};function k(){var n=Object(v.a)(["\n  width: 100%;\n  margin: 6.45px 0;\n  background-color: transparent;\n  -webkit-appearance: none;\n\n  &:focus {\n    outline: none;\n  }\n  &::-webkit-slider-runnable-track {\n    background-color: #eae7e9;\n    border: 1px solid rgba(177, 176, 178, 0.7);\n    border-radius: 5.1px;\n    width: 100%;\n    height: 7.1px;\n    cursor: pointer;\n  }\n  &::-webkit-slider-thumb {\n    margin-top: -7.45px;\n    width: 20px;\n    height: 20px;\n    background-color: #f56c42;\n    border: 1px solid #10091e;\n    border-radius: 20px;\n    cursor: pointer;\n    -webkit-appearance: none;\n  }\n  &:focus::-webkit-slider-runnable-track {\n    background-color: #f56c42;\n  }\n  &::-moz-range-track {\n    background-color: #eae7e9;\n    border: 1px solid rgba(177, 176, 178, 0.7);\n    border-radius: 5.1px;\n    width: 100%;\n    height: 7.1px;\n    cursor: pointer;\n  }\n  &::-moz-range-thumb {\n    width: 20px;\n    height: 20px;\n    background-color: #f56c42;\n    border: 1px solid #10091e;\n    border-radius: 20px;\n    cursor: pointer;\n  }\n  &::-ms-track {\n    background-color: transparent;\n    border-color: transparent;\n    border-width: 7.65px 0;\n    color: transparent;\n    width: 100%;\n    height: 7.1px;\n    cursor: pointer;\n  }\n  &::-ms-fill-lower {\n    background-color: #cbc4c9;\n    border: 1px solid rgba(177, 176, 178, 0.7);\n    border-radius: 10.2px;\n  }\n  &::-ms-fill-upper {\n    background-color: #eae7e9;\n    border: 1px solid rgba(177, 176, 178, 0.7);\n    border-radius: 10.2px;\n  }\n  &::-ms-thumb {\n    width: 20px;\n    height: 20px;\n    background-color: #f56c42;\n    border: 1px solid #10091e;\n    border-radius: 20px;\n    cursor: pointer;\n    margin-top: 0px;\n    /*Needed to keep the Edge thumb centred*/\n  }\n  &:focus::-ms-fill-lower {\n    background-color: #eae7e9;\n  }\n  &:focus::-ms-fill-upper {\n    background-color: #ffffff;\n  }\n"]);return k=function(){return n},n}var S=u.d.input(k()),I=function(n,e){var t=function(t){(null===n||void 0===n?void 0:n.current)&&!(null===n||void 0===n?void 0:n.current.contains(t.target))&&e()};Object(r.useEffect)((function(){return document.addEventListener("click",t),function(){document.removeEventListener("click",t)}}))};function C(){var n=Object(v.a)(["\n  font-size: ",";\n  font-weight: ",";\n  margin-bottom: 0.25rem;\n  display: block;\n"]);return C=function(){return n},n}function z(){var n=Object(v.a)(["\n  flex: 1 1 auto;\n  transition: opacity 4s ease-in;\n  display: ",";\n  opacity: ",";\n  margin-right: 5rem;\n"]);return z=function(){return n},n}function R(){var n=Object(v.a)(["\n  position: absolute;\n  right: 1rem;\n  width: 2rem;\n  height: 2rem;\n  text-align: right;\n"]);return R=function(){return n},n}function D(){var n=Object(v.a)(["\n  position: fixed;\n  display: flex;\n  border-radius: 1rem;\n  justify-items: center;\n\n  top: 0.25rem;\n  right: 0.25rem;\n  width: 3rem;\n  height: 3rem;\n  padding: 1rem;\n  transition: all 0.3s ease-in-out;\n  max-height: 320px;\n  max-width: 15rem;\n  width: ",";\n  height: ",";\n  background: ",";\n  box-shadow: ",";\n"]);return D=function(){return n},n}function L(){var n=Object(v.a)(["\n  margin: 1rem 0;\n  padding: 0.35rem 1rem;\n  border-radius: 5px;\n  color: ",";\n  font-size: ",";\n  border: none;\n  background: ",";\n"]);return L=function(){return n},n}function P(){var n=Object(v.a)(["\n  font-size: ",";\n  margin: 0;\n  padding: 0;\n  margin-bottom: 1rem;\n"]);return P=function(){return n},n}var T=u.d.h3(P(),(function(n){return n.theme.fontSize.base})),N=u.d.button(L(),(function(n){return n.theme.color.white}),(function(n){return n.theme.fontSize.small}),(function(n){return n.theme.color.hslBlue})),M=u.d.div(D(),(function(n){return n.menuOpen?"100vw":"2rem"}),(function(n){return n.menuOpen?"100vh":"2rem"}),(function(n){return n.menuOpen?"#fff":"transparent"}),(function(n){return n.menuOpen?"0 0.25rem 1rem rgba(1, 1, 1, 0.5)":"none"})),W=u.d.img(R()),F=u.d.div(z(),(function(n){return n.menuOpen?"block":"none"}),(function(n){return n.menuOpen?1:0})),q=u.d.label(C(),(function(n){return n.theme.fontSize.small}),(function(n){return n.theme.fontWeight.medium})),$=function(){var n=a.a.useRef(null),e=a.a.useContext(w),t=e.radiusInMeters,r=e.setRadiusInMeters,o=e.setCurrentRoute,i=a.a.useState(t),c=Object(b.a)(i,2),u=c[0],l=c[1],d=a.a.useState(!1),f=Object(b.a)(d,2),m=f[0],p=f[1],h=j(u,300);return I(n,(function(){m&&p(!1)})),a.a.useEffect((function(){var n;r(h),null===(n=localStorage)||void 0===n||n.setItem("HSLTestRadius",h)}),[h,r]),a.a.createElement(M,{menuOpen:m,ref:n},a.a.createElement(W,{src:m?O.a:y.a,onClick:function(){p(!m)}}),a.a.createElement(F,{menuOpen:m},a.a.createElement(T,null,"Settings"),a.a.createElement(q,{htmlFor:"radius"},"Max walking (",u," m)"),a.a.createElement(S,{name:"radius",type:"range",min:"20",step:"20",max:s.maxRadius,value:u,onChange:function(n){l(n.target.value)}}),a.a.createElement(N,{onClick:function(){o({color:null,coordinates:null})}},"Clear Route")))};function A(){var n=Object(v.a)(["\n  position: absolute;\n  z-index: 100000;\n"]);return A=function(){return n},n}var B=u.d.header(A()),G=function(){return a.a.createElement(B,{className:"HSL-test-header"},a.a.createElement($,null))},H=t(78),V=t(79),U=t.n(V),J=t(80),K=t.n(J),Q=t(81),Y=t.n(Q),_=t(82),X=t.n(_),Z=t(83),nn=t.n(Z),en=t(84),tn=t.n(en),rn=function(n){switch(n){case 0:return{transportName:"Tram",color:l.color.hslGreen};case 1:return{transportName:"Metro",color:l.color.hslOrange};case 2:return{transportName:"Train",color:l.color.hslPurple};case 3:return{transportName:"Bus",color:l.color.hslBlue};case 4:return{transportName:"Ferry",color:l.color.hlsLightBlue};default:return{transportName:"Unknown",color:l.color.orange}}},an=function(n){switch(n){case 0:return K.a;case 1:return X.a;case 2:return Y.a;case 3:return U.a;case 4:return nn.a;default:return tn.a}},on={lat:0,lng:0},cn=function(n){var e=n.children,t=a.a.useState(on),r=Object(b.a)(t,2),o=r[0],i=r[1],c=a.a.useState(on),u=Object(b.a)(c,2),l=u[0],d=u[1],f=a.a.useState(function(){var n,e=null===(n=localStorage)||void 0===n?void 0:n.getItem("HSLTestRadius");if(e&&!isNaN(parseInt(e))){var t=parseInt(e);return t>s.maxRadius?s.maxRadius:t}return s.initialRadius}()),m=Object(b.a)(f,2),p=m[0],h=m[1],g=a.a.useState({coordinates:null,color:"black"}),v=Object(b.a)(g,2),x=v[0],y=v[1],E=a.a.useState(null),O=Object(b.a)(E,2),j=O[0],k=O[1],S=a.a.useState({vehicleType:-1,direction:"",vehicleCode:""}),I=Object(b.a)(S,2),C={initialLocation:o,setInitialLocation:i,geoLocation:l,setGeoLocation:d,radiusInMeters:p,setRadiusInMeters:h,currentRoute:x,setCurrentRoute:y,stopData:j,setStopData:k,vehicleData:I[0],setVehicleData:I[1]};return a.a.createElement(w.Provider,{value:C},e)};function un(){var n=Object(v.a)(["\n  background: ",";\n  color: ",";\n  padding: 0.5rem 1.5rem;\n  font-weight: 700;\n  font-size: 1.2rem;\n  border-radius: 0.25rem;\n  border: none;\n"]);return un=function(){return n},n}function ln(){var n=Object(v.a)(["\n  text-align: center;\n"]);return ln=function(){return n},n}function sn(){var n=Object(v.a)(["\n  margin: auto;\n  width: 300px;\n  min-height: 100px;\n  padding: 1rem;\n  background: #fff;\n  text-align: center;\n  border-radius: 0.5rem;\n"]);return sn=function(){return n},n}function dn(){var n=Object(v.a)(["\n  position: absolute;\n  background: rgba(1, 1, 1, 0.5);\n  width: 100vw;\n  height: 100vh;\n  z-index: 10000;\n  display: flex;\n  align-items: center;\n  justify-items: center;\n"]);return dn=function(){return n},n}var fn=u.d.div(dn()),mn=u.d.div(sn()),pn=u.d.h1(ln()),hn=u.d.button(un(),(function(n){return n.theme.color.hslGreen}),(function(n){return n.theme.color.white})),gn=function(){return a.a.createElement(fn,null,a.a.createElement(mn,null,a.a.createElement(pn,null,"Geolocation is turned off :("),a.a.createElement("h3",null,"You have to turn Geolocation on in order to use the functionality."),a.a.createElement(hn,{onClick:function(){window.location.reload()}},"Refresh")))},vn=function(n){var e=n.children,t=a.a.useContext(w).setGeoLocation,r=a.a.useState(!1),o=Object(b.a)(r,2),i=o[0],c=o[1];return a.a.useEffect((function(){var n;return navigator.geolocation&&(c(!1),n=navigator.geolocation.watchPosition((function(n){var e=n.coords;t({lat:Number(e.latitude.toFixed(4)),lng:Number(e.longitude.toFixed(4))})}),(function(){c(!0)}),{enableHighAccuracy:!0})),function(){var e,t;navigator.geolocation&&n&&(null===(e=navigator)||void 0===e||null===(t=e.geolocation)||void 0===t||t.clearWatch(n))}}),[t,c]),i?a.a.createElement(gn,null):a.a.createElement(a.a.Fragment,null,e)},bn=t(118),xn=t(117),yn=t(119),En=t(121),On=t(52),wn=t.n(On),jn=t(85),kn=t(23),Sn=t.n(kn);function In(){var n=Object(v.a)(["\n  query getStopsByRadius(\n    $lat: Float!\n    $lon: Float!\n    $radius: Int!\n    $first: Int\n  ) {\n    stopsByRadius(lat: $lat, lon: $lon, radius: $radius, first: $first) {\n      edges {\n        node {\n          stop {\n            gtfsId\n            name\n            code\n            locationType\n            vehicleType\n            lat\n            lng: lon\n            platformCode\n          }\n          distance\n        }\n      }\n    }\n  }\n"]);return In=function(){return n},n}var Cn=Sn()(In()),zn=function(){var n=a.a.useContext(w),e=n.geoLocation,t=n.radiusInMeters,r=n.setStopData,o=Object(c.useApolloClient)();return a.a.useEffect((function(){(function(){var n=Object(jn.a)(wn.a.mark((function n(){var a,i,c,u;return wn.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o.query({query:Cn,fetchPolicy:"no-cache",notifyOnNetworkStatusChange:!0,variables:{lat:e.lat,lon:e.lng,radius:t}});case 2:c=n.sent,(null===(u=c.data)||void 0===u||null===(a=u.stopsByRadius)||void 0===a||null===(i=a.edges)||void 0===i?void 0:i.length)>0&&r(u);case 5:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}})()()}),[o,e.lat,e.lng,t,r]),a.a.createElement(a.a.Fragment,null)},Rn=t(115),Dn=t(120);function Ln(){var n=Object(v.a)(["\n  display: flex;\n  flex-wrap: wrap;\n  flex: 1 1 0;\n  flex-direction: column;\n  justify-content: center;\n  line-height: 1.1;\n  margin-left: 1rem;\n"]);return Ln=function(){return n},n}function Pn(){var n=Object(v.a)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  font-weight: ",";\n  font-size: ",";\n  "," {\n    opacity: 0;\n  }\n  &:hover {\n    cursor: pointer;\n    "," {\n      transition: all 0.2s linear;\n      opacity: 1;\n    }\n  }\n"]);return Pn=function(){return n},n}function Tn(){var n=Object(v.a)(["\n  color: ",";\n  font-size: ",";\n  position: absolute;\n  top: 0.125rem;\n  right: 0.25rem;\n"]);return Tn=function(){return n},n}function Nn(){var n=Object(v.a)(["\n  font-weight: ",";\n  color: ",";\n  font-size: ",";\n  white-space: nowrap;\n  max-width: 100%;\n  overflow: hidden;\n  text-overflow: ellipsis;\n"]);return Nn=function(){return n},n}function Mn(){var n=Object(v.a)(["\n  display: block;\n  font-size: ",";\n  color: ",";\n"]);return Mn=function(){return n},n}function Wn(){var n=Object(v.a)(["\n  font-weight: ",";\n  font-size: ",";\n  margin-left: 0.25rem;\n  width: 3rem;\n"]);return Wn=function(){return n},n}function Fn(){var n=Object(v.a)(["\n  font-weight: ",";\n"]);return Fn=function(){return n},n}function qn(){var n=Object(v.a)(["\n  font-size: ",";\n  color: ",";\n  margin-right: 0.25rem;\n  margin-top: 2px;\n  ",";\n"]);return qn=function(){return n},n}function $n(){var n=Object(v.a)(["\n  animation: "," 2s linear infinite;\n"]);return $n=function(){return n},n}function An(){var n=Object(v.a)(["\n  0% {\n    opacity: 0;\n  }\n\n  50% {\n   opacity: 1;\n  }\n  100% {\n    opacity: 0;\n  }\n"]);return An=function(){return n},n}var Bn=Object(u.e)(An()),Gn=Object(u.c)($n(),Bn),Hn=u.d.span(qn(),(function(n){return n.theme.fontSize.h2}),(function(n){return n.isDelayed?"red":"green"}),(function(n){return n.isRealtime&&Gn})),Vn=u.d.span(Fn(),(function(n){return n.theme.fontWeight.medium})),Un=u.d.span(Wn(),(function(n){return n.theme.fontWeight.medium}),(function(n){return n.theme.fontSize.big})),Jn=u.d.span(Mn(),(function(n){return n.theme.fontSize.xsmall}),(function(n){return n.theme.color.grayLight})),Kn=u.d.span(Nn(),(function(n){return n.theme.fontWeight.normal}),(function(n){return n.theme.color.gray}),(function(n){return n.theme.fontSize.small})),Qn=u.d.div(Tn(),(function(n){return n.theme.color.grayLight}),(function(n){return n.theme.fontSize.small})),Yn=u.d.div(Pn(),(function(n){return n.theme.fontWeight.normal}),(function(n){return n.theme.fontSize.base}),Qn,Qn),_n=u.d.div(Ln()),Xn=function(n){var e=n.stopInformation,t=n.vehicleType,r=n.isFirst,o=e.trip.tripGeometry.points,i=a.a.useContext(w),c=i.setCurrentRoute,u=i.setVehicleData,l=rn(t).color,s=e.realtime,d=e.realtimeDeparture,f=e.headsign,m=e.arrivalDelay,p=e.trip.gtfsId,h=void 0===p?"":p,g=e.trip.route.shortName,v=m>0,b=v&&function(n){var e=Math.floor(n/60),t=n-60*e;return"".concat(e>0?e+"min ":"").concat(t,"s")}(m),x=function(n){var e=Object(H.toReadableTime)(n),t=e.hours,r=e.minutes;return"PM"===e.meridian?"".concat(parseInt(t)+12,".").concat(r):"".concat("12"===t?"0":t,".").concat(r)}(d);a.a.useEffect((function(){if(r){var n=function(n,e){var t=n.split("_"),r=t[0].split(":")[1];return{vehicleType:e,direction:t[3],vehicleCode:r}}(h,t);u(n)}}),[r,u,h,t]);return a.a.createElement(Yn,{onClick:function(){c({color:l,coordinates:o})}},a.a.createElement(Qn,null,"show route"),a.a.createElement(Hn,{isDelayed:v,isRealtime:s},"\u2022"),a.a.createElement(Un,null,x," ",b&&a.a.createElement(Jn,null,"~",b," late")),a.a.createElement(_n,null,a.a.createElement(Vn,null,g),a.a.createElement(Kn,null,f)))};function Zn(){var n=Object(v.a)(["\n  padding: 0.5rem 0 1.5rem;\n"]);return Zn=function(){return n},n}var ne=u.d.div(Zn()),ee=function(n){var e,t=n.stopData;return a.a.createElement(ne,null,null===t||void 0===t||null===(e=t.stoptimesWithoutPatterns)||void 0===e?void 0:e.map((function(n,e){return a.a.createElement(Xn,{key:"stopInfo-".concat(e),isFirst:0===e,stopInformation:n,vehicleType:t.vehicleType})})))};function te(){var n=Object(v.a)(["\n  query getStopTimetable($id: String!) {\n    stop(id: $id) {\n      name\n      code\n      locationType\n      vehicleType\n      platformCode\n      stoptimesWithoutPatterns(omitNonPickups: true, omitCanceled: false) {\n        scheduledArrival\n        realtimeArrival\n        arrivalDelay\n        scheduledDeparture\n        realtimeDeparture\n        departureDelay\n        realtime\n        realtimeState\n        headsign\n        trip {\n          gtfsId\n          id\n          directionId\n          tripGeometry {\n            length\n            points\n          }\n          route {\n            gtfsId\n            shortName\n            stops {\n              name\n              gtfsId\n            }\n          }\n        }\n      }\n    }\n  }\n"]);return te=function(){return n},n}var re=Sn()(te());function ae(){var n=Object(v.a)(["\n  animation: none;\n"]);return ae=function(){return n},n}function oe(){var n=Object(v.a)(["\n  ",";\n"]);return oe=function(){return n},n}function ie(){var n=Object(v.a)(["\n  margin-top: 0.25rem;\n  font-size: ",";\n  color: ",";\n  text-align: center;\n"]);return ie=function(){return n},n}function ce(){var n=Object(v.a)(["\n  display: block;\n  width: 2rem;\n  height: 2rem;\n  margin: 0.25rem auto;\n"]);return ce=function(){return n},n}function ue(){var n=Object(v.a)(["\n  text-align: center;\n  margin-bottom: 0;\n"]);return ue=function(){return n},n}function le(){var n=Object(v.a)(["\n  margin-top: 0.5rem;\n  font-weight: ",";\n"]);return le=function(){return n},n}function se(){var n=Object(v.a)(["\n  padding-bottom: 0.5rem;\n  border-bottom: 2px solid ",";\n  text-align: center;\n  font-size: ",";\n  color: ",";\n  font-weight: ",";\n"]);return se=function(){return n},n}var de=u.d.div(se(),(function(n){return n.borderColor}),(function(n){return n.theme.fontSize.small}),(function(n){return n.theme.color.blackLighter}),(function(n){return n.theme.fontWeight.light})),fe=u.d.div(le(),(function(n){return n.theme.fontWeight.medium})),me=u.d.h2(ue()),pe=u.d.img(ce()),he=u.d.div(ie(),(function(n){return n.theme.fontSize.small}),(function(n){return n.theme.color.grayLight})),ge=u.d.span(oe(),Gn),ve=Object(u.d)(ge)(ae()),be=function(n){var e=n.stopId,t=n.distance,r=n.name,o=n.vehicleType,i=n.code,u=Object(c.useLazyQuery)(re,{fetchPolicy:"no-cache",variables:{id:e},pollInterval:2e4}),l=Object(b.a)(u,2),s=l[0],d=l[1],f=d.loading,m=d.error,p=d.data,h=d.stopPolling;a.a.useEffect((function(){return function(){h&&h()}}),[h]);var g=an(o),v=rn(o).color;return a.a.createElement(Rn.a,{maxWidth:320,minWidth:250,onOpen:s,onClose:function(){h&&h()},autoPan:!1},f&&a.a.createElement("div",null,"Loading..."),m&&a.a.createElement("div",null,"Error fetching info"),a.a.createElement(fe,null,a.a.createElement(me,null,a.a.createElement(pe,{src:g}),r),a.a.createElement(de,{borderColor:v},t," m (",i,")"),a.a.createElement("div",null,p&&a.a.createElement(ee,{stopData:p.stop})),a.a.createElement(he,null,a.a.createElement("div",null,a.a.createElement(ge,null,"\u2022")," Realtime Departure"),a.a.createElement(ve,null,"\u2022")," Scheduled departure")))},xe=function(n){var e=n.center,t=n.radius,r=n.stopData,o=n.distance,i=n.stopId,c=r.name,u=r.code,s=r.platformCode,d=r.vehicleType,f=rn(d);return a.a.createElement(Dn.a,{center:e,radius:t,color:l.color.blackLighter,opacity:1,fillColor:f.color,fillOpacity:.7},a.a.createElement(be,{stopId:i,distance:o,name:c,code:s||u,vehicleType:d}))},ye=function(){var n,e,t=a.a.useContext(w).stopData,r=[];return t?null===t||void 0===t||null===(n=t.stopsByRadius)||void 0===n||null===(e=n.edges)||void 0===e?void 0:e.map((function(n,e){var t=n.node,o=t.stop,i=o.gtfsId,c=o.lat,u=o.lng,l=t.distance;if(-1===r.indexOf(i))return r.push(i),a.a.createElement(xe,{key:i,stopId:o.gtfsId,center:[c,u],radius:6,stopData:o,closest:0===e,distance:l})})):a.a.createElement(a.a.Fragment,null)},Ee=t(116),Oe=t(86),we=t.n(Oe),je=function(){var n=a.a.useContext(w).currentRoute;if(!n.coordinates)return a.a.createElement(a.a.Fragment,null);var e=we()(n.coordinates);return a.a.createElement(Ee.a,{positions:e,weight:8,color:n.color||l.color.black})},ke=t(43),Se=t(15),Ie=t(87),Ce=t.n(Ie),ze=t(17);function Re(){var n=Object(v.a)(["\n  subscription getRealtimeVehicleData($topic: String!) {\n    subscribe2vehicleData(topic: $topic) {\n      spd\n      hdg\n      lat\n      long\n      start\n    }\n  }\n"]);return Re=function(){return n},n}var De=Sn()(Re()),Le=t(88),Pe=t.n(Le);function Te(){var n=Object(v.a)(["\n  opacity: ",";\n  transform: rotate(","deg);\n  position: absolute;\n  margin-left: 10px;\n  margin-top: -27px;\n  width: 9px;\n  height: 9px;\n"]);return Te=function(){return n},n}function Ne(){var n=Object(v.a)(["\n  opacity: ",";\n  width: 30px;\n  height: auto;\n  border: none;\n  background: none;\n"]);return Ne=function(){return n},n}var Me=u.d.img(Ne(),(function(n){return!n.moving&&.6})),We=u.d.img(Te(),(function(n){return!n.moving&&.6}),(function(n){return n.degrees})),Fe=function(){var n=a.a.useContext(w).vehicleData,e=n.vehicleCode,t=n.direction,r=n.vehicleType,o=an(r),i=a.a.useRef({}),u=a.a.useRef(null),l="/hfp/v2/journey/+/vp/+/+/+/".concat(e,"/").concat(t,"/#"),s=Object(c.useSubscription)(De,{variables:{topic:l},shouldResubscribe:e+t!==(null===u||void 0===u?void 0:u.current)}).data;return s||(i.current={}),a.a.useEffect((function(){u.current=e+t}),[e,n,t]),a.a.useEffect((function(){if(s){var n=null===s||void 0===s?void 0:s.subscribe2vehicleData,e=n.lat,t=n.long,r=n.start,a=n.hdg,o=n.spd;i.current=Object(Se.a)(Object(Se.a)({},i.current),{},Object(ke.a)({},r,{lat:e,long:t,hdg:a,spd:o}))}else i.current={}}),[s]),a.a.createElement(a.a.Fragment,null,Object.keys(i.current).map((function(n){var e=i.current[n],t=e.lat,r=e.long,c=e.hdg,u=e.spd,l=Object(ze.divIcon)({html:Ce.a.renderToString(a.a.createElement(a.a.Fragment,null,a.a.createElement(Me,{src:o,alt:"vehicle",moving:u>1}),a.a.createElement(We,{src:Pe.a,alt:"vehicle",degrees:c,moving:u>1}))),className:"vehicle",iconSize:[0,0],shadowSize:[0,0],iconAnchor:[7,10]}),s={lat:t,lng:r};return a.a.createElement(xn.a,{key:n,position:s,icon:l})})))};function qe(){var n=Object(v.a)(["\n  width: 100%;\n  height: 100vh;\n"]);return qe=function(){return n},n}var $e=u.d.div(qe()),Ae=function(){var n=a.a.useContext(w).geoLocation,e=Object(bn.a)();return a.a.useEffect((function(){e.locate(),e.on("locationfound",(function(n){e.setView(n.latlng,17)}))}),[e]),a.a.createElement(xn.a,{position:n})},Be=function(){var n=s.hslMap,e=s.initialPositionCoords;return a.a.createElement($e,null,a.a.createElement(yn.a,{center:e,zoom:17},a.a.createElement(En.a,{url:n,tileSize:256,attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),a.a.createElement(Ae,null),a.a.createElement(zn,null),a.a.createElement(ye,null),a.a.createElement(je,null),a.a.createElement(Fe,null)))};function Ge(){var n=Object(v.a)(['\n  body {\n    margin: 0;\n    padding: 0;\n    font-family: "Open Sans", Helvetica, Sans-Serif;\n  }\n  h1, h2, h3, h4, h5 {\n    font-family: "Ubuntu", "Open Sans", Helvetica, Sans-Serif;\n    font-weight: 700;\n  }\n  p, div, span {\n    font-family: "Ubuntu", "Open Sans", Helvetica, Sans-Serif;\n    font-weight: 500;\n  }\n']);return Ge=function(){return n},n}var He=Object(u.b)(Ge()),Ve=function(){return a.a.createElement(u.a,{theme:l},a.a.createElement(He,null),a.a.createElement(c.ApolloProvider,{client:g},a.a.createElement(cn,null,a.a.createElement(vn,null,a.a.createElement(G,null),a.a.createElement(Be,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(Ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(n){n.unregister()})).catch((function(n){console.error(n.message)}))},73:function(n,e,t){n.exports=t.p+"static/media/menu.597d55c7.svg"},74:function(n,e,t){n.exports=t.p+"static/media/x.6a954980.svg"},79:function(n,e,t){n.exports=t.p+"static/media/bus.e832c78f.svg"},80:function(n,e,t){n.exports=t.p+"static/media/tram.008e5640.svg"},81:function(n,e,t){n.exports=t.p+"static/media/train.6e260072.svg"},82:function(n,e,t){n.exports=t.p+"static/media/subway.68e26a10.svg"},83:function(n,e,t){n.exports=t.p+"static/media/ferry.1717a18b.svg"},84:function(n,e,t){n.exports=t.p+"static/media/vehicle.cb8deca8.svg"},88:function(n,e,t){n.exports=t.p+"static/media/triangle.0af5b0f0.svg"},89:function(n,e,t){n.exports=t(113)},94:function(n,e,t){},95:function(n,e,t){}},[[89,1,2]]]);
//# sourceMappingURL=main.5bc61177.chunk.js.map